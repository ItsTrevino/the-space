<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="sv"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;3D-rum&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>html,body,#app { height:100%; margin:0; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>#app { width:100%; height:100vh; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- Three.js (globala builds) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"&gt;&lt;/script&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="app"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>(function(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const CONF = {</p>
<p class="p1"><span class="Apple-converted-space">      </span>room: { width: 4.0, depth: 4.1, height: 3.1, wallThickness: 0.3 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>surfaces: { wallColor: 0xeeeeee, ceilingColor: 0xeeeeee, floorColor: 0x111111 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>windows: [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ wall:"back", centerX:-1.0, width:1.5, bottom:0.65, height:2.35, recess:0.4 },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ wall:"back", centerX: 1.0, width:1.5, bottom:0.65, height:2.35, recess:0.4 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>],</p>
<p class="p1"><span class="Apple-converted-space">      </span>openingsRight: { height:2.1, width:1.0, gapBetween:1.0 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>shopPortal: { color:0x9aa0a6, url:"https://SHOP_URL_HERE" },</p>
<p class="p1"><span class="Apple-converted-space">      </span>stairs: { steps:5, width:2.2, rise:0.18, depth:0.35, offsetFromWall:0.5 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>intro:<span class="Apple-converted-space">  </span>{ sweepSeconds:3.2, enterSeconds:0.9 }</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const el = document.getElementById("app");</p>
<p class="p1"><span class="Apple-converted-space">    </span>const W=CONF.room.width, D=CONF.room.depth, H=CONF.room.height, WT=CONF.room.wallThickness;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const HALF_W=W/2, HALF_D=D/2;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const scene = new THREE.Scene();</p>
<p class="p1"><span class="Apple-converted-space">    </span>scene.background = new THREE.Color(0xf5f5f5);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const camera = new THREE.PerspectiveCamera(60, el.clientWidth/el.clientHeight, 0.05, 200);</p>
<p class="p1"><span class="Apple-converted-space">    </span>camera.position.set(2.8,1.1,5.5);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const renderer = new THREE.WebGLRenderer({ antialias:true });</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderer.setPixelRatio(Math.min(2, window.devicePixelRatio||1));</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderer.setSize(el.clientWidth, el.clientHeight);</p>
<p class="p1"><span class="Apple-converted-space">    </span>el.appendChild(renderer.domElement);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>scene.add(new THREE.HemisphereLight(0xffffff,0x7a7a7a,0.9));</p>
<p class="p1"><span class="Apple-converted-space">    </span>const dir = new THREE.DirectionalLight(0xffffff,0.85); dir.position.set(4,6,3); scene.add(dir);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const matWall = new THREE.MeshStandardMaterial({ color: CONF.surfaces.wallColor, roughness:0.95 });</p>
<p class="p1"><span class="Apple-converted-space">    </span>const matCeil = new THREE.MeshStandardMaterial({ color: CONF.surfaces.ceilingColor, roughness:0.95 });</p>
<p class="p1"><span class="Apple-converted-space">    </span>const matFloor= new THREE.MeshStandardMaterial({ color: CONF.surfaces.floorColor, roughness:1.0 });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Floor &amp; ceiling</p>
<p class="p1"><span class="Apple-converted-space">    </span>const floor=new THREE.Mesh(new THREE.PlaneGeometry(W,D),matFloor);</p>
<p class="p1"><span class="Apple-converted-space">    </span>floor.rotation.x=-Math.PI/2; floor.position.set(0,0,-HALF_D); scene.add(floor);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ceil=new THREE.Mesh(new THREE.PlaneGeometry(W,D),matCeil);</p>
<p class="p1"><span class="Apple-converted-space">    </span>ceil.rotation.x= Math.PI/2; ceil.position.set(0,H,-HALF_D); scene.add(ceil);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Walls with openings</p>
<p class="p1"><span class="Apple-converted-space">    </span>function addWallSegments(axis,pos,length,height,opens){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const g=new THREE.Group(), holes=(opens||[]).slice().sort((a,b)=&gt;a.center-b.center);</p>
<p class="p1"><span class="Apple-converted-space">      </span>let cursor=-length/2;</p>
<p class="p1"><span class="Apple-converted-space">      </span>function seg(w){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const m=new THREE.Mesh(new THREE.BoxGeometry(w,height,WT),matWall);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(axis==="z"){ m.position.set(cursor+w/2,height/2,pos); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>else { m.position.set(pos,height/2,cursor+w/2); m.rotation.y=Math.PI/2; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>g.add(m); cursor+=w;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>holes.forEach(o=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">        </span>const left=(o.center-o.width/2)-cursor; if(left&gt;0.001) seg(left);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const overH=height-(o.bottom+o.height);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(overH&gt;0.001){</p>
<p class="p1"><span class="Apple-converted-space">          </span>const top=new THREE.Mesh(new THREE.BoxGeometry(o.width,overH,WT),matWall);</p>
<p class="p1"><span class="Apple-converted-space">          </span>if(axis==="z"){ top.position.set(o.center,o.bottom+o.height+overH/2,pos); }</p>
<p class="p1"><span class="Apple-converted-space">          </span>else { top.position.set(pos,o.bottom+o.height+overH/2,o.center); top.rotation.y=Math.PI/2; }</p>
<p class="p1"><span class="Apple-converted-space">          </span>g.add(top);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>cursor=o.center+o.width/2;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const right=length/2-cursor; if(right&gt;0.001) seg(right);</p>
<p class="p1"><span class="Apple-converted-space">      </span>scene.add(g); return g;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Windows (recessed)</p>
<p class="p1"><span class="Apple-converted-space">    </span>function addRecessedWindow(w){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const glass=new THREE.Mesh(new THREE.PlaneGeometry(w.width,w.height),</p>
<p class="p1"><span class="Apple-converted-space">        </span>new THREE.MeshPhysicalMaterial({ color:0xffffff, roughness:0.15, transmission:0.9, transparent:true }));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const y=w.bottom+w.height/2, zFront=-D-WT/2+w.recess; glass.position.set(w.centerX,y,zFront);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sideMat=new THREE.MeshStandardMaterial({ color: CONF.surfaces.wallColor, roughness:0.95 });</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sideL=new THREE.Mesh(new THREE.BoxGeometry(0.04,w.height,w.recess),sideMat);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sideR=sideL.clone(), top=new THREE.Mesh(new THREE.BoxGeometry(w.width,0.04,w.recess),sideMat);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sill=top.clone();</p>
<p class="p1"><span class="Apple-converted-space">      </span>sideL.position.set(w.centerX-w.width/2,y,zFront+w.recess/2);</p>
<p class="p1"><span class="Apple-converted-space">      </span>sideR.position.set(w.centerX+w.width/2,y,zFront+w.recess/2);</p>
<p class="p1"><span class="Apple-converted-space">      </span>top.position.set(w.centerX,y+w.height/2,zFront+w.recess/2);</p>
<p class="p1"><span class="Apple-converted-space">      </span>sill.position.set(w.centerX,y-w.height/2,zFront+w.recess/2);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const grp=new THREE.Group(); grp.add(glass,sideL,sideR,top,sill); scene.add(grp);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Build walls</p>
<p class="p1"><span class="Apple-converted-space">    </span>addWallSegments("z", 0, <span class="Apple-converted-space">  </span>W, H, []); // front</p>
<p class="p1"><span class="Apple-converted-space">    </span>const backOpens=CONF.windows.map(w=&gt;({center:w.centerX,bottom:w.bottom,width:w.width,height:w.height}));</p>
<p class="p1"><span class="Apple-converted-space">    </span>addWallSegments("z", -D,<span class="Apple-converted-space">  </span>W, H, backOpens); // back</p>
<p class="p1"><span class="Apple-converted-space">    </span>addWallSegments("x", -W/2, D, H, []); <span class="Apple-converted-space">      </span>// left</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Right wall – IN/UT openings</p>
<p class="p1"><span class="Apple-converted-space">    </span>const oW=CONF.openingsRight.width, oH=CONF.openingsRight.height, GAP=CONF.openingsRight.gapBetween;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const centerGap=GAP+oW, midZ=-HALF_D; const INz=midZ-centerGap/2, UTz=midZ+centerGap/2;</p>
<p class="p1"><span class="Apple-converted-space">    </span>addWallSegments("x",<span class="Apple-converted-space">  </span>W/2, D, H, [</p>
<p class="p1"><span class="Apple-converted-space">      </span>{center:INz,bottom:0,width:oW,height:oH},</p>
<p class="p1"><span class="Apple-converted-space">      </span>{center:UTz,bottom:0,width:oW,height:oH},</p>
<p class="p1"><span class="Apple-converted-space">    </span>]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Portals (IN = markering, UT = clickable)</p>
<p class="p1"><span class="Apple-converted-space">    </span>const clickTargets=[];</p>
<p class="p1"><span class="Apple-converted-space">    </span>function addPortalOnRight(centerZ,w,h,color,clickable,onClick){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const panel=new THREE.Mesh(new THREE.PlaneGeometry(w*0.98,h*0.98),</p>
<p class="p1"><span class="Apple-converted-space">        </span>new THREE.MeshStandardMaterial({color,roughness:0.9,transparent:true,opacity:0.9}));</p>
<p class="p1"><span class="Apple-converted-space">      </span>panel.position.set(W/2+0.02,h/2,centerZ); panel.rotation.y=Math.PI/2; scene.add(panel);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(clickable){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const hit=new THREE.Mesh(new THREE.PlaneGeometry(w,h), new THREE.MeshBasicMaterial({visible:false}));</p>
<p class="p1"><span class="Apple-converted-space">        </span>hit.position.copy(panel.position); hit.rotation.copy(panel.rotation);</p>
<p class="p1"><span class="Apple-converted-space">        </span>hit.userData.onClick=onClick; clickTargets.push(hit); scene.add(hit);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>addPortalOnRight(INz,oW,oH,0xb0b0b0,false,null);</p>
<p class="p1"><span class="Apple-converted-space">    </span>addPortalOnRight(UTz,oW,oH,CONF.shopPortal.color,true,()=&gt;window.open(CONF.shopPortal.url,"_blank"));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Add windows</p>
<p class="p1"><span class="Apple-converted-space">    </span>CONF.windows.forEach(addRecessedWindow);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Stairs near IN</p>
<p class="p1"><span class="Apple-converted-space">    </span>(function(){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const s=CONF.stairs, g=new THREE.Group();</p>
<p class="p1"><span class="Apple-converted-space">      </span>const baseX=W/2 + s.offsetFromWall + s.depth/2, baseZ=INz;</p>
<p class="p1"><span class="Apple-converted-space">      </span>for(let i=0;i&lt;s.steps;i++){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const step=new THREE.Mesh(new THREE.BoxGeometry(s.width,s.rise,s.depth),</p>
<p class="p1"><span class="Apple-converted-space">          </span>new THREE.MeshStandardMaterial({color:0xdedede,roughness:0.95}));</p>
<p class="p1"><span class="Apple-converted-space">        </span>step.position.set(baseX - i*s.depth,(i+0.5)*s.rise,baseZ); g.add(step);</p>
<p class="p1"><span class="Apple-converted-space">      </span>} scene.add(g);</p>
<p class="p1"><span class="Apple-converted-space">    </span>})();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Orbit + intro</p>
<p class="p1"><span class="Apple-converted-space">    </span>const controls=new THREE.OrbitControls(camera,renderer.domElement);</p>
<p class="p1"><span class="Apple-converted-space">    </span>controls.enabled=false; controls.enablePan=false;</p>
<p class="p1"><span class="Apple-converted-space">    </span>controls.target.set(0,1.3,-HALF_D);</p>
<p class="p1"><span class="Apple-converted-space">    </span>controls.minDistance=1.0; controls.maxDistance=Math.max(W,D); controls.maxPolarAngle=Math.PI*0.75;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>let phase=0,t=0, T_SWEEP=CONF.intro.sweepSeconds, T_ENTER=CONF.intro.enterSeconds;</p>
<p class="p1"><span class="Apple-converted-space">    </span>function eio(q){return q&lt;0.5?2*q*q:-1+(4-2*q)*q;}</p>
<p class="p1"><span class="Apple-converted-space">    </span>function intro(dt){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(phase===0){</p>
<p class="p1"><span class="Apple-converted-space">        </span>t=Math.min(1,t+dt/T_SWEEP); const k=eio(t);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const startX=W/2+3.5, endX=W/2+0.6, x=startX+(endX-startX)*k;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const y=1.0+0.4*Math.sin(k*Math.PI), z=INz+0.8*Math.sin(k*Math.PI*0.5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>camera.position.set(x,y,z); camera.lookAt(W/2,1.2,INz);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(t&gt;=1){phase=1;t=0;}</p>
<p class="p1"><span class="Apple-converted-space">      </span>} else if(phase===1){</p>
<p class="p1"><span class="Apple-converted-space">        </span>t=Math.min(1,t+dt/T_ENTER); const k=eio(t);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const from=new THREE.Vector3(W/2+0.6,1.2,INz), to=new THREE.Vector3(W/2-1.2,1.2,INz);</p>
<p class="p1"><span class="Apple-converted-space">        </span>camera.position.copy(from.lerp(to,k)); camera.lookAt(0,1.3,-HALF_D);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(t&gt;=1){phase=2; controls.enabled=true;}</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Click (UT)</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ray=new THREE.Raycaster(), mouse=new THREE.Vector2();</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderer.domElement.addEventListener("click", e=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const r=renderer.domElement.getBoundingClientRect();</p>
<p class="p1"><span class="Apple-converted-space">      </span>mouse.x=((e.clientX-r.left)/r.width)*2-1; mouse.y=-((e.clientY-r.top)/r.height)*2+1;</p>
<p class="p1"><span class="Apple-converted-space">      </span>ray.setFromCamera(mouse,camera);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const hits=ray.intersectObjects(clickTargets,true);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(hits.length &amp;&amp; hits[0].object.userData.onClick) hits[0].object.userData.onClick();</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Loop &amp; resize</p>
<p class="p1"><span class="Apple-converted-space">    </span>let last=performance.now();</p>
<p class="p1"><span class="Apple-converted-space">    </span>function tick(now){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const dt=Math.min(0.033,(now-last)/1000); last=now;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(phase!==2) intro(dt); if(controls.enabled) controls.update();</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderer.render(scene,camera); requestAnimationFrame(tick);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>requestAnimationFrame(tick);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>window.addEventListener("resize", ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>camera.aspect=el.clientWidth/el.clientHeight; camera.updateProjectionMatrix();</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderer.setSize(el.clientWidth, el.clientHeight);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>})();</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
