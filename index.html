<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Diagnos – JS & Three</title>
<style>
  html,body{height:100%;margin:0}
  #app{min-height:100%;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center;font:16px system-ui}
  .ok{color:#0a7d00}.bad{color:#b00020}
  canvas{border:1px solid #ddd;max-width:90vw;max-height:60vh}
</style>
</head>
<body>
<div id="app"><div>Startar diagnos…</div></div>

<script>
(function(){
  const root = document.getElementById('app');
  const log = (txt, ok=true) => {
    const p = document.createElement('div');
    p.className = ok ? 'ok' : 'bad';
    p.textContent = (ok ? '✔︎ ' : '✖︎ ') + txt;
    root.appendChild(p);
  };

  // 1) Inline-JS körs?
  log('Inline-JavaScript körs');

  // 2) Rita i 2D-canvas utan Three.js
  const c = document.createElement('canvas');
  c.width = 400; c.height = 250;
  const cx = c.getContext('2d');
  cx.fillStyle = '#ff3b7b';
  cx.fillRect(0,0,c.width,c.height);
  cx.fillStyle = '#fff';
  cx.font = '20px system-ui';
  cx.fillText('Canvas 2D OK', 120, 130);
  root.appendChild(c);
  log('Canvas 2D ritade utan fel');

  // 3) Ladda Three.js dynamiskt
  function load(src){
    return new Promise((res, rej)=>{
      const s = document.createElement('script');
      s.src = src; s.onload = res; s.onerror = ()=>rej(new Error('Kunde inte ladda '+src));
      document.head.appendChild(s);
    });
  }

  Promise.resolve()
    .then(()=>load('https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js'))
    .then(()=>{
      log('Three.js script inläst');
      // Skapa en enkel scen med blå bakgrund + röd kub
      const wrap = document.createElement('div');
      root.appendChild(wrap);
      const scene = new THREE.Scene(); scene.background = new THREE.Color(0x6aa9ff);
      const camera = new THREE.PerspectiveCamera(60, 400/250, 0.1, 100);
      camera.position.set(2.5,1.8,3.5);
      const renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize(400,250);
      wrap.appendChild(renderer.domElement);
      scene.add(new THREE.HemisphereLight(0xffffff,0x444444,1.2));
      const box = new THREE.Mesh(
        new THREE.BoxGeometry(1,1,1),
        new THREE.MeshStandardMaterial({color:0xff0000})
      );
      scene.add(box);
      (function tick(){ box.rotation.y+=0.01; renderer.render(scene,camera); requestAnimationFrame(tick); })();
      log('Three.js renderar (blå bakgrund + röd kub ska synas)');
    })
    .catch(err=>{
      console.error(err);
      log(err.message || String(err), false);
      log('Testa byta CDN till unpkg i koden om detta steg faller.', false);
    });
})();
</script>
</body>
</html>
